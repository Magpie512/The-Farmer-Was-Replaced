MAX_ROW_DEPTH = 11

NON_PUMPKIN_COLUMNS = [
	(Entities.Grass, Grounds.Grassland),
	(Entities.Bush, None),
	(Entities.Carrot, Grounds.Soil),
	(Entities.Sunflower, Grounds.Soil),
	(Entities.Tree, Grounds.Soil),
	(Entities.Grass, Grounds.Grassland),
]

PUMPKIN_COLUMN = (Entities.Pumpkin, Grounds.Soil)

def process_space(entity_to_plant, required_ground_type, col_index, row_index):
	is_special_bush = (col_index == 1) and (row_index == 11)

	if can_harvest():
		if is_special_bush:
			if get_entity_type() == entity_to_plant:
				harvest()
		else:
			harvest()

	if required_ground_type != None:
		current_ground = get_ground_type()

		if current_ground != required_ground_type:
			till()

	if entity_to_plant != None:
		if is_special_bush:
			if get_entity_type() != entity_to_plant:
				plant(entity_to_plant)
		else:
			plant(entity_to_plant)

	if get_water() < 1000 and num_items(Items.Water) > 0:
		use_item(Items.Water)

	if num_items(Items.Fertilizer) > 0:
		if is_special_bush:
			use_item(Items.Fertilizer)
		else:
			use_item(Items.Fertilizer)


def sweep_column(entity_to_plant, required_ground_type, col_index):
	process_space(entity_to_plant, required_ground_type, col_index, 0)

	for row_index in range(1, MAX_ROW_DEPTH + 1): 
		move(South)
		process_space(entity_to_plant, required_ground_type, col_index, row_index)

	for count in range(MAX_ROW_DEPTH):
		move(North)


clear()
change_hat(Hats.Wizard_Hat)

while True:
	
	for index in range(len(NON_PUMPKIN_COLUMNS)):
		entity = NON_PUMPKIN_COLUMNS[index][0]
		ground_type = NON_PUMPKIN_COLUMNS[index][1]

		sweep_column(entity, ground_type, index)

		if index < len(NON_PUMPKIN_COLUMNS) - 1:
			move(East)

	move(East)
	
	PUMPKIN_ENTITY, PUMPKIN_GROUND = PUMPKIN_COLUMN
	
	for count in range(6): 
		sweep_column(PUMPKIN_ENTITY, PUMPKIN_GROUND, 99)
		
		if count < 5:
			move(East)

	for count in range(MAX_ROW_DEPTH):
		move(West)
